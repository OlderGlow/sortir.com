{% extends 'base.html.twig' %}
{% block title %}
    Accueil | sortir.com
{% endblock %}
{% block body %}
    <!-- Affichage des infos demandés sur la page d'accueil -->
    <div class="container">
        <div class="text-right">
            <p><u>Participant</u> : {{ app.user.prenom }} {{ app.user.nom|first }}.</p>
            <p><u>Date du jour</u> : {{ "now"|date("d/m/Y", "Europe/Paris") }}</p>
        </div>
    </div>
    <!-- Début de l'affichage des filtres -->
    <div class="container">
        <div class="col-lg-12">
            <div class="row">
                <a href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample"
                   data-toggle="collapse" class="col-sm-12" style="margin-bottom: 4rem;"><h4
                            class="text-left">
                        Filtrer les sorties <i class="fa fa-arrow-down" aria-hidden="true"></i>
                    </h4>
                </a>


            </div>
        </div>

        <div class="collapse" id="collapseExample">
        <div class="jumbotron">
            <div class="col-lg-12">
                <div class="row">
                    <div class="col-lg-6">
                        <div style="width: max-content">
                            {{ form_start(form) }}
                            {{ form_row(form.campus) }}
                            {{ form_row(form.q) }}
                            <div class="row">
                                <div class="ml-3">{{ form_row(form.dateStart) }}</div>
                                <div class="ml-3"> {{ form_row(form.dateEnd) }}</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4">

                        {{ form_row(form.sortieOrganisateur) }}
                        {{ form_row(form.sortieInscrit) }}
                        {{ form_row(form.noInscrit) }}
                        {{ form_row(form.datePasse) }}
                    </div>
                    <div class="col-lg-2">
                        <button type="submit" class="btn btn-primary">Rechercher</button>
                    </div>
                    {{ form_end(form) }}
                </div>
            </div>
        </div>
        </div>
    </div>
    <!-- Début de l'affichage des sorties -->
    <div class="row">
        <div class="col-sm-12"><h2 class="text-center">Liste des <b>sorties</b></h2></div>


    </div>
    <div class="container-xl mt-5">
    <div class="table-responsive col-lg-12 mx-auto">
    <div class="table">
    <div class="table-title">
        <div class="row">
            <table class="table table-striped table-hover table-bordered mt-4" id="myTable2">
                {% for message in app.flashes('success') %}
                    <div class="alert alert-success col-lg-12">
                        {{ message }}
                    </div>
                {% endfor %}

                <thead class="thead-dark">
                <tr>
                    <th class="text-center" onclick="sortTable(0)">Nom de la sortie</th>
                    <th class="text-center" onclick="sortTable(0)">Date de la sortie</th>
                    <th class="text-center" onclick="sortTable(0)">Clôture</th>
                    <th class="text-center" onclick="sortTable(0)">Inscrit/Places</th>
                    <th class="text-center" onclick="sortTable(0)">État</th>
                    <th class="text-center" onclick="sortTable(0)">Inscrit</th>
                    <th class="text-center" onclick="sortTable(0)">Organisateur</th>
                    <th class="text-center">Actions</th>
                </tr>
                </thead>
                {% for sortie in sorties %}

                    <tbody class="bg-white">
                    <tr>
                        <td class="text-center">{{ sortie.nom }}</td>
                        <td class="text-center">{{ sortie.datedebut | date('d/m/Y') }}</td>
                        <td class="text-center">{{ sortie.datecloture | date('d/m/Y') }}</td>
                        <td class="text-center">{{ sortie.estInscrit|length }}/{{ sortie.nbinscriptionsmax }}</td>
                        <td class="text-center">{{ sortie.etats.libelle }}</td>
                        <td class="text-center">{% if sortie.estInscrit.first.id is defined %}

                                {% for sortieInscrit in sortie.estInscrit %}
                                    {% if sortieInscrit.id == app.user.id %}X{% endif %}
                                {% endfor %}
                            {% endif %}

                        </td>
                        <td class="text-center"><a href="{{ path('participant.detail', {id: sortie.organisateur.id}) }}">{{ sortie.organisateur.pseudo }}</a></td>
                        <td class="text-center">
                            {% if sortie.etats.libelle == 'Ouverte' %}Afficher - S'inscrire{% endif %}
                            {% if sortie.etats.libelle == 'Créée' %}Modifier - Publier{% endif %}
                            {% if sortie.etats.libelle == 'Clôturée' %}Afficher{% endif %}
                            {% if sortie.etats.libelle == 'Activité en cours' %}Afficher{% endif %}
                            {% if sortie.etats.libelle == 'Passée' %}Afficher {% endif %}
                            {% if sortie.etats.libelle == 'Annulée' %}Modifier {% endif %}
                        </td>
                    </tr>
                    </tbody>

                {% endfor %}
            </table>

            <a href="{{ path('sortie.add') }}" class="btn btn-primary">Ajoutez une sortie</a>
        </div>
    </div>
{% endblock %}